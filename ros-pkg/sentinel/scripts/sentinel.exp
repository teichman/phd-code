#!/usr/bin/expect

spawn date
expect "\\$"

send_user "passwd:"
stty -echo
expect_user -re "(.*)\n" {set PASSWD $expect_out(1,string)}
send_user "\n"
stty echo

set timeout 10

while { 1 } {
    spawn rsync -av --size-only .sentinel_log rg:~/
    expect "password:" { send -- "$PASSWD\r" }
    expect "\\$"

    sleep 60
    
    spawn date
    expect "\\$"
}
